2025-09-12 10:09:33 INFO: - Rank: -1, Saving log file to checkpoint/llama3/evaluation_w_0.0.log ...
2025-09-12 10:09:33 INFO: - Loading data from /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json ... 
从文件名自动解析得到权重: w = 0.0
权重值: 0.0
输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
日志文件: checkpoint/llama3/evaluation_w_0.0.log
正在加载数据集...
正在加载分词器: "/home/jiangjp/models/Meta-Llama-3-8B-Instruct"，padding_side: "left"
缺少padding token，设置padding token为eos_token
正在加载模型...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.25s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]
开始评估...
正在评估权重 w = 0.0
输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
数据集大小: 100
评估 w=0.0:   0%|          | 0/25 [00:00<?, ?it/s]/home/jiangjp/miniconda3/envs/trace/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
评估 w=0.0:   4%|▍         | 1/25 [00:04<01:44,  4.36s/it]评估 w=0.0:   8%|▊         | 2/25 [00:08<01:34,  4.11s/it]评估 w=0.0:  12%|█▏        | 3/25 [00:12<01:35,  4.32s/it]评估 w=0.0:  16%|█▌        | 4/25 [00:20<01:57,  5.60s/it]评估 w=0.0:  20%|██        | 5/25 [00:24<01:38,  4.91s/it]评估 w=0.0:  24%|██▍       | 6/25 [00:30<01:40,  5.28s/it]评估 w=0.0:  28%|██▊       | 7/25 [00:34<01:31,  5.06s/it]评估 w=0.0:  32%|███▏      | 8/25 [00:40<01:31,  5.36s/it]评估 w=0.0:  36%|███▌      | 9/25 [00:44<01:15,  4.71s/it]评估 w=0.0:  40%|████      | 10/25 [00:48<01:08,  4.54s/it]评估 w=0.0:  44%|████▍     | 11/25 [00:53<01:08,  4.86s/it]评估 w=0.0:  48%|████▊     | 12/25 [01:00<01:11,  5.51s/it]评估 w=0.0:  52%|█████▏    | 13/25 [01:04<01:00,  5.05s/it]评估 w=0.0:  56%|█████▌    | 14/25 [01:08<00:52,  4.74s/it]样本0 正确:
  生成答案: 'April 1858'
  最佳正确答案概率: 0.374095 ('April 1858')
样本1 错误:
  生成答案: 'Dushanbe International Airport'
  正确答案: ['Stockholm Arlanda Airport', 'Arlanda Airport', 'ARN']
  最佳正确答案概率: 0.000000 ('Stockholm Arlanda Airport')
样本2 错误:
  生成答案: 'Ulimang'
  正确答案: ['Kapan']
  最佳正确答案概率: 0.000000 ('Kapan')
样本3 错误:
  生成答案: 'Le Verrier'
  正确答案: ['Chinese']
  最佳正确答案概率: 0.000000 ('Chinese')
样本4 错误:
  生成答案: 'January 2005'
  正确答案: ['1993']
  最佳正确答案概率: 0.000297 ('1993')
样本5 错误:
  生成答案: 'There is not enough information provided to answer the question. The question asks about the population of the state where the Mississippi River begins'
  正确答案: ['1.7 million']
  最佳正确答案概率: 0.000000 ('1.7 million')
样本7 错误:
  生成答案: 'The Francis Parkman House.'
  正确答案: ['hotels', 'Hotel', 'hotel']
  最佳正确答案概率: 0.009347 ('Hotel')
样本8 错误:
  生成答案: 'Gainesville, Florida'
  正确答案: ['University of Nebraska']
  最佳正确答案概率: 0.000000 ('University of Nebraska')
样本9 错误:
  生成答案: 'New Brunswick'
  正确答案: ['Anglican Church of Canada']
  最佳正确答案概率: 0.000005 ('Anglican Church of Canada')
样本10 错误:
  生成答案: 'Based on the provided context, there is no information about the number of private schools in a Canadian city that was one of the'
  正确答案: ['three']
  最佳正确答案概率: 0.000001 ('three')
样本11 错误:
  生成答案: 'None, Sabaneta is a municipality in Colombia, not Guinea-Bissau.'
  正确答案: ['Iván Duque']
  最佳正确答案概率: 0.000000 ('Iván Duque')
样本12 错误:
  生成答案: 'Not mentioned in the context.'
  正确答案: ['August 12, 1898']
  最佳正确答案概率: 0.000000 ('August 12, 1898')
样本13 错误:
  生成答案: 'None of the given contexts mention anyone making a host city their capital.'
  正确答案: ['Dorgon']
  最佳正确答案概率: 0.000000 ('Dorgon')
样本14 错误:
  生成答案: 'Christ'
  正确答案: ['a red cross on a white field', 'Red Cross']
  最佳正确答案概率: 0.000000 ('Red Cross')
样本17 错误:
  生成答案: '1898'
  正确答案: ['1842']
  最佳正确答案概率: 0.001742 ('1842')
样本18 错误:
  生成答案: 'Idris'
  正确答案: ['KPA']
  最佳正确答案概率: 0.000000 ('KPA')
样本19 错误:
  生成答案: 'WDVX'
  正确答案: ['Fleetwood Mac']
  最佳正确答案概率: 0.000000 ('Fleetwood Mac')
样本20 错误:
  生成答案: 'United States'
  正确答案: ['Norway', 'NO', 'NOR', 'no']
  最佳正确答案概率: 0.000191 ('Norway')
样本21 错误:
  生成答案: 'Eritrea was not annexed by anyone. It gained independence from Ethiopia in 1991.'
  正确答案: ['1953']
  最佳正确答案概率: 0.000005 ('1953')
样本22 错误:
  生成答案: 'None of the above.'
  正确答案: ['establishment of the Roman Empire.', 'Roman Empire']
  最佳正确答案概率: 0.000001 ('Roman Empire')
样本23 错误:
  生成答案: 'University of Southern California'
  正确答案: ['Visva-Bharati University']
  最佳正确答案概率: 0.000000 ('Visva-Bharati University')
样本24 错误:
  生成答案: 'There is no mention of the XXX Corps invading an island in the given contexts. The contexts mention the Soviet invasion of Poland,'
  正确答案: ['1773']
  最佳正确答案概率: 0.000000 ('1773')
样本25 错误:
  生成答案: 'Kurdistan.'
  正确答案: ['Kurdish people']
  最佳正确答案概率: 0.026151 ('Kurdish people')
样本26 错误:
  生成答案: 'I'm happy to help! However, I noticed that the question doesn't match the context provided. The context is about Ent'
  正确答案: ['eastern tip']
  最佳正确答案概率: 0.000000 ('eastern tip')
样本27 错误:
  生成答案: 'Dave Grohl'
  正确答案: ['Peter Grant']
  最佳正确答案概率: 0.000027 ('Peter Grant')
样本28 错误:
  生成答案: 'Europe'
  正确答案: ['Central Asia']
  最佳正确答案概率: 0.000024 ('Central Asia')
样本29 错误:
  生成答案: 'None of the given contexts provide information about the performer of "Walk on the Wild Side" or their college attendance.'
  正确答案: ['Syracuse University', 'Cuse', 'SU']
  最佳正确答案概率: 0.000074 ('Syracuse University')
样本30 错误:
  生成答案: 'Tommy Kaye'
  正确答案: ['Laura Kelly']
  最佳正确答案概率: 0.000000 ('Laura Kelly')
样本31 错误:
  生成答案: 'Estonia'
  正确答案: ['United States', 'America', 'US of A', 'US', 'the United States']
  最佳正确答案概率: 0.219699 ('United States')
样本33 错误:
  生成答案: 'None.'
  正确答案: ['Italian painter']
  最佳正确答案概率: 0.000000 ('Italian painter')
样本34 错误:
  生成答案: 'John Lennon'
  正确答案: ['Alfred Lennon']
  最佳正确答案概率: 0.000009 ('Alfred Lennon')
样本35 错误:
  生成答案: 'Ross Stores'
  正确答案: ['KaDeWe']
  最佳正确答案概率: 0.000000 ('KaDeWe')
样本36 错误:
  生成答案: 'Trinidad and Tobago.'
  正确答案: ['1960']
  最佳正确答案概率: 0.000000 ('1960')
样本37 错误:
  生成答案: 'Season 11.'
  正确答案: ['September 25, 2014']
  最佳正确答案概率: 0.000000 ('September 25, 2014')
样本38 错误:
  生成答案: 'Prairie Creek'
  正确答案: ['Ohio River']
  最佳正确答案概率: 0.004982 ('Ohio River')
样本40 错误:
  生成答案: 'The jurisdiction to which the Anthem of Europe applies is the European Union.'
  正确答案: ["Europe's most innovative country", 'Europe']
  最佳正确答案概率: 0.001663 ('Europe')
样本42 错误:
  生成答案: 'New York City Health and Hospitals Corporation (HHC)'
  正确答案: ['The World Health Organization (WHO)', 'WHO', 'World Health Organization']
  最佳正确答案概率: 0.000001 ('WHO')
样本43 错误:
  生成答案: 'France'
  正确答案: ['December 1917']
  最佳正确答案概率: 0.000000 ('December 1917')
样本44 错误:
  生成答案: 'Ghana.'
  正确答案: ['Sophia Akuffo']
  最佳正确答案概率: 0.000000 ('Sophia Akuffo')
样本45 错误:
  生成答案: '1649'
  正确答案: ['1895']
  最佳正确答案概率: 0.000006 ('1895')
样本46 错误:
  生成答案: 'Because it is the 50-star flag of the United States.'
  正确答案: ['represented the island of Puerto Rico', 'PR', 'Puerto Rico']
  最佳正确答案概率: 0.038232 ('Puerto Rico')
样本47 错误:
  生成答案: 'There is no information in the given context that answers the question about the Pantheon in the death place of the Vix P'
  正确答案: ['temple, now a church', 'Temple', 'temple']
  最佳正确答案概率: 0.000000 ('Temple')
样本48 错误:
  生成答案: '1970s'
  正确答案: ['1909']
  最佳正确答案概率: 0.000024 ('1909')
样本49 错误:
  生成答案: '16 or 17 years'
  正确答案: ['24 hours a day']
  最佳正确答案概率: 0.000000 ('24 hours a day')
样本50 正确:
  生成答案: 'Antarctica'
  最佳正确答案概率: 0.523240 ('Antarctica')
样本51 错误:
  生成答案: 'Connecticut'
  正确答案: ['Rhode Island Department of Transportation', 'RIDOT']
  最佳正确答案概率: 0.000000 ('Rhode Island Department of Transportation')
样本52 错误:
  生成答案: 'David Ben-Gurion'
  正确答案: ['Charles Carroll']
  最佳正确答案概率: 0.000000 ('Charles Carroll')
样本53 错误:
  生成答案: 'Rome'
  正确答案: ['Castel Gandolfo']
  最佳正确答案概率: 0.000002 ('Castel Gandolfo')
样本54 错误:
  生成答案: 'Delegates to the Second Continental Congress.'
  正确答案: ['Charles Carroll']
  最佳正确答案概率: 0.000000 ('Charles Carroll')
样本55 错误:
  生成答案: 'Joseph Chiarello'
  正确答案: ['Catherine Zeta-Jones']
  最佳正确答案概率: 0.000000 ('Catherine Zeta-Jones')
样本56 错误:
  生成答案: 'meat and rice'
  正确答案: ['yak meat']
评估 w=0.0:  60%|██████    | 15/25 [01:15<00:52,  5.21s/it]评估 w=0.0:  64%|██████▍   | 16/25 [01:20<00:47,  5.29s/it]评估 w=0.0:  68%|██████▊   | 17/25 [01:22<00:34,  4.36s/it]评估 w=0.0:  72%|███████▏  | 18/25 [01:27<00:31,  4.50s/it]评估 w=0.0:  76%|███████▌  | 19/25 [01:37<00:37,  6.26s/it]评估 w=0.0:  80%|████████  | 20/25 [01:42<00:29,  5.82s/it]评估 w=0.0:  84%|████████▍ | 21/25 [01:50<00:25,  6.37s/it]评估 w=0.0:  88%|████████▊ | 22/25 [01:53<00:16,  5.43s/it]评估 w=0.0:  92%|█████████▏| 23/25 [01:57<00:10,  5.08s/it]评估 w=0.0:  96%|█████████▌| 24/25 [02:01<00:04,  4.78s/it]评估 w=0.0: 100%|██████████| 25/25 [02:09<00:00,  5.48s/it]评估 w=0.0: 100%|██████████| 25/25 [02:09<00:00,  5.16s/it]
2025-09-12 10:11:56 INFO: - 评估完成
2025-09-12 10:11:56 INFO: - 权重值: 0.0
2025-09-12 10:11:56 INFO: - 输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
2025-09-12 10:11:56 INFO: - 评估结果: {'weight_w': 0.0, 'input_file': '/home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json', 'total_samples': 100, 'exact_match': 0.11, 'f1': 0.1702094572094572, 'precision': 0.17462499999999997, 'recall': 0.17566666666666667, 'avg_max_log_prob': -15.070397355409732, 'avg_max_prob': 0.08358334415941311, 'avg_total_prob': 0.08360169566939002, 'valid_max_prob_samples': 100, 'invalid_max_prob_samples': 0, 'avg_answer_count': 1.48, 'avg_valid_answer_count': 1.48}
2025-09-12 10:11:56 INFO: - 结果已保存至: /home/jiangjp/trace-idea/results/myidea/MuSiQue/fakenum1/idealsetting/w00/sample_correct_probabilities_w_0.0_triples.json
  最佳正确答案概率: 0.000000 ('yak meat')
样本57 错误:
  生成答案: 'Joan McBride'
  正确答案: ['former Acting Mayor London Breed', 'London Breed']
  最佳正确答案概率: 0.000000 ('London Breed')
样本59 错误:
  生成答案: 'Guaíra Airport'
  正确答案: ['Tân Sơn Nhất International Airport', 'SGN', 'Tan Son Nhat International Airport']
  最佳正确答案概率: 0.000000 ('Tân Sơn Nhất International Airport')
样本60 错误:
  生成答案: 'Mariner 10 and Voyager probes.'
  正确答案: ['Voyager probes']
  最佳正确答案概率: 0.241772 ('Voyager probes')
样本62 错误:
  生成答案: '785'
  正确答案: ['5th–6th centuries', '6th century', '6th-century']
  最佳正确答案概率: 0.000000 ('6th century')
样本63 错误:
  生成答案: 'Pope Paul IV (1555-1565)'
  正确答案: ['March 44 BC']
  最佳正确答案概率: 0.000000 ('March 44 BC')
样本64 错误:
  生成答案: 'Evan James Springsteen'
  正确答案: ['Harper Simon']
  最佳正确答案概率: 0.000000 ('Harper Simon')
样本65 错误:
  生成答案: '1957-1959'
  正确答案: ['six months']
  最佳正确答案概率: 0.000000 ('six months')
样本66 错误:
  生成答案: 'Adam Barlow'
  正确答案: ['James McCartney']
  最佳正确答案概率: 0.000003 ('James McCartney')
样本67 错误:
  生成答案: 'Hawaii'
  正确答案: ['808']
  最佳正确答案概率: 0.014942 ('808')
样本68 错误:
  生成答案: 'Renault'
  正确答案: ['Louis Renault']
  最佳正确答案概率: 0.000000 ('Louis Renault')
样本69 错误:
  生成答案: 'UTF-16'
  正确答案: ['WGL-4 with 652 characters']
  最佳正确答案概率: 0.000000 ('WGL-4 with 652 characters')
样本70 错误:
  生成答案: 'There is no country where Bandar Mas is located.'
  正确答案: ['Pakatan Harapan']
  最佳正确答案概率: 0.000000 ('Pakatan Harapan')
样本71 错误:
  生成答案: 'Lok Sabha'
  正确答案: ['Parliament of India']
  最佳正确答案概率: 0.000050 ('Parliament of India')
样本72 错误:
  生成答案: 'Stanford University'
  正确答案: ['Harvard']
  最佳正确答案概率: 0.000100 ('Harvard')
样本73 错误:
  生成答案: 'None. The context does not mention the inconsistent late season play of any team, nor does it mention'
  正确答案: ['unusually high number of day games', 'd', 'day', 'Day', 'days']
  最佳正确答案概率: 0.000228 ('d')
样本74 错误:
  生成答案: 'I'm happy to help! However, I noticed that the question seems to be missing some context. The question asks about the'
  正确答案: ['a month', 'Month', 'month']
  最佳正确答案概率: 0.000000 ('Month')
样本75 错误:
  生成答案: 'English'
  正确答案: ['totals remain relatively small in relation to the total U.S population.', 'the US', 'America', 'U.S.', 'the United States', 'United States', 'US']
  最佳正确答案概率: 0.000058 ('America')
样本76 错误:
  生成答案: 'There is no mention of Admiral Twin or Heller Theatre in the given context. The context only talks about Roy Clark Celebrity Theatre,'
  正确答案: ['1998']
  最佳正确答案概率: 0.000264 ('1998')
样本77 错误:
  生成答案: 'John F. Kennedy Stadium'
  正确答案: ['Lincoln Financial Field']
  最佳正确答案概率: 0.000268 ('Lincoln Financial Field')
样本78 错误:
  生成答案: 'Hank Williams Jr.'
  正确答案: ['Aldemaro Romero']
  最佳正确答案概率: 0.000000 ('Aldemaro Romero')
样本79 错误:
  生成答案: 'Robin Roberts'
  正确答案: ['Amna Ilyas']
  最佳正确答案概率: 0.000000 ('Amna Ilyas')
样本80 错误:
  生成答案: 'United States'
  正确答案: ['off the north - western coast of the European mainland']
  最佳正确答案概率: 0.000000 ('off the north - western coast of the European mainland')
样本81 错误:
  生成答案: 'Anguilla'
  正确答案: ['a key part of the Spanish Empire']
  最佳正确答案概率: 0.000000 ('a key part of the Spanish Empire')
样本82 错误:
  生成答案: 'Sarasota'
  正确答案: ['165,521']
  最佳正确答案概率: 0.000000 ('165,521')
样本83 错误:
  生成答案: 'Malusi Gigaba'
  正确答案: ['Sudhir Mungantiwar']
  最佳正确答案概率: 0.000000 ('Sudhir Mungantiwar')
样本84 错误:
  生成答案: 'The Nile.'
  正确答案: ['Blue Nile']
  最佳正确答案概率: 0.000256 ('Blue Nile')
样本85 错误:
  生成答案: 'John G. Rice'
  正确答案: ['Steve Jobs']
  最佳正确答案概率: 0.041754 ('Steve Jobs')
样本86 错误:
  生成答案: 'Lionsgate'
  正确答案: ['Elliot Handler']
  最佳正确答案概率: 0.000000 ('Elliot Handler')
样本87 错误:
  生成答案: 'There is no mention of WJLD in the context, and the context only talks about Weeks Creek and its location in San'
  正确答案: ['49']
  最佳正确答案概率: 0.000280 ('49')
样本88 错误:
  生成答案: 'Andrew Johnson.'
  正确答案: ['Arkansas Attorney General']
  最佳正确答案概率: 0.000000 ('Arkansas Attorney General')
样本89 错误:
  生成答案: '20th Century Records'
  正确答案: ['RCA Records', 'RCA']
  最佳正确答案概率: 0.000035 ('RCA')
样本90 错误:
  生成答案: 'Olsztyn'
  正确答案: ['Kapan']
  最佳正确答案概率: 0.000000 ('Kapan')
样本91 错误:
  生成答案: 'Vespasia'
  正确答案: ['Marcia']
  最佳正确答案概率: 0.000068 ('Marcia')
样本92 错误:
  生成答案: 'National Railway Museum'
  正确答案: ['National Rail Museum']
  最佳正确答案概率: 0.078928 ('National Rail Museum')
样本93 错误:
  生成答案: 'The Near East.'
  正确答案: ['"the East Indies"', 'East Indies']
  最佳正确答案概率: 0.000016 ('East Indies')
样本94 错误:
  生成答案: 'There is no university of George Low.'
  正确答案: ['1824']
  最佳正确答案概率: 0.000000 ('1824')
样本95 错误:
  生成答案: 'Nintendo'
  正确答案: ['first-party games']
  最佳正确答案概率: 0.000000 ('first-party games')
样本97 错误:
  生成答案: 'Werther'
  正确答案: ['Alberto Savinio']
  最佳正确答案概率: 0.000000 ('Alberto Savinio')
样本98 错误:
  生成答案: 'Rhode Island'
  正确答案: ['Seth Magaziner']
  最佳正确答案概率: 0.000000 ('Seth Magaziner')
样本99 错误:
  生成答案: 'Heian-kyō'
  正确答案: ['Qiantang']
  最佳正确答案概率: 0.000000 ('Qiantang')

============================================================
评估结果
============================================================
weight_w: 0.000000
input_file: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
total_samples: 100
exact_match: 0.110000
f1: 0.170209
precision: 0.174625
recall: 0.175667
avg_max_log_prob: -15.070397
avg_max_prob: 0.083583
avg_total_prob: 0.083602
valid_max_prob_samples: 100
invalid_max_prob_samples: 0
avg_answer_count: 1.480000
avg_valid_answer_count: 1.480000
============================================================

结果已保存至: /home/jiangjp/trace-idea/results/myidea/MuSiQue/fakenum1/idealsetting/w00/sample_correct_probabilities_w_0.0_triples.json

统计信息:
平均每个问题有 1.5 个正确答案
平均每个问题有 1.5 个有效概率的答案
有效概率样本: 100 / 100
