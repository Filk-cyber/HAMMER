2025-09-12 10:11:58 INFO: - Rank: -1, Saving log file to checkpoint/llama3/evaluation_w_0.0.log ...
2025-09-12 10:11:58 INFO: - Loading data from /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json ... 
从文件名自动解析得到权重: w = 0.0
权重值: 0.0
输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
日志文件: checkpoint/llama3/evaluation_w_0.0.log
正在加载数据集...
正在加载分词器: "/home/jiangjp/models/Meta-Llama-3-8B-Instruct"，padding_side: "left"
缺少padding token，设置padding token为eos_token
正在加载模型...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.15s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.24s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.16it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.01s/it]
开始评估...
正在评估权重 w = 0.0
输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
数据集大小: 100
评估 w=0.0:   0%|          | 0/25 [00:00<?, ?it/s]/home/jiangjp/miniconda3/envs/trace/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
评估 w=0.0:   4%|▍         | 1/25 [00:07<03:11,  7.97s/it]评估 w=0.0:   8%|▊         | 2/25 [00:16<03:08,  8.18s/it]评估 w=0.0:  12%|█▏        | 3/25 [00:23<02:46,  7.57s/it]评估 w=0.0:  16%|█▌        | 4/25 [00:42<04:13, 12.06s/it]评估 w=0.0:  20%|██        | 5/25 [00:50<03:38, 10.91s/it]评估 w=0.0:  24%|██▍       | 6/25 [01:11<04:26, 14.04s/it]评估 w=0.0:  28%|██▊       | 7/25 [01:19<03:38, 12.14s/it]评估 w=0.0:  32%|███▏      | 8/25 [01:33<03:37, 12.77s/it]评估 w=0.0:  36%|███▌      | 9/25 [01:41<03:02, 11.40s/it]评估 w=0.0:  40%|████      | 10/25 [01:53<02:50, 11.40s/it]评估 w=0.0:  44%|████▍     | 11/25 [02:03<02:34, 11.07s/it]评估 w=0.0:  48%|████▊     | 12/25 [02:15<02:28, 11.45s/it]评估 w=0.0:  52%|█████▏    | 13/25 [02:26<02:14, 11.23s/it]样本0 错误:
  生成答案: '1858.'
  正确答案: ['April 1858']
  最佳正确答案概率: 0.230704 ('April 1858')
样本1 错误:
  生成答案: 'Dushanbe International Airport'
  正确答案: ['Stockholm Arlanda Airport', 'Arlanda Airport', 'ARN']
  最佳正确答案概率: 0.000000 ('Stockholm Arlanda Airport')
样本2 错误:
  生成答案: 'Ngaraard'
  正确答案: ['Kapan']
  最佳正确答案概率: 0.000000 ('Kapan')
样本3 错误:
  生成答案: 'None.'
  正确答案: ['Chinese']
  最佳正确答案概率: 0.000010 ('Chinese')
样本4 错误:
  生成答案: 'Jay R released his first album in an unknown context, as the provided context only mentions his fourth studio album, "Soul'
  正确答案: ['1993']
  最佳正确答案概率: 0.000000 ('1993')
样本5 错误:
  生成答案: 'I'm happy to help! However, I must point out that the context provided does not mention the state where the Mississippi River'
  正确答案: ['1.7 million']
  最佳正确答案概率: 0.000000 ('1.7 million')
样本6 错误:
  生成答案: 'Mississippi'
  正确答案: ['34th']
  最佳正确答案概率: 0.013513 ('34th')
样本7 错误:
  生成答案: 'The Francis Parkman House.'
  正确答案: ['hotels', 'Hotel', 'hotel']
  最佳正确答案概率: 0.000312 ('Hotel')
样本8 错误:
  生成答案: 'Humacao, Puerto Rico'
  正确答案: ['University of Nebraska']
  最佳正确答案概率: 0.000000 ('University of Nebraska')
样本9 错误:
  生成答案: 'Canada'
  正确答案: ['Anglican Church of Canada']
  最佳正确答案概率: 0.000000 ('Anglican Church of Canada')
样本10 错误:
  生成答案: 'There is no information about private schools in the given contexts. The contexts are about Green Bay, Wisconsin, and the History of'
  正确答案: ['three']
  最佳正确答案概率: 0.000000 ('three')
样本11 错误:
  生成答案: 'There is no information about presidential elections in the context about Sabaneta, Antioquia.'
  正确答案: ['Iván Duque']
  最佳正确答案概率: 0.000000 ('Iván Duque')
样本12 错误:
  生成答案: 'Hawaii'
  正确答案: ['August 12, 1898']
  最佳正确答案概率: 0.000030 ('August 12, 1898')
样本13 错误:
  生成答案: 'Seoul.'
  正确答案: ['Dorgon']
  最佳正确答案概率: 0.000000 ('Dorgon')
样本14 错误:
  生成答案: 'Christ'
  正确答案: ['a red cross on a white field', 'Red Cross']
  最佳正确答案概率: 0.000000 ('Red Cross')
样本17 错误:
  生成答案: 'Hong Kong'
  正确答案: ['1842']
  最佳正确答案概率: 0.205301 ('1842')
样本18 错误:
  生成答案: 'Italy'
  正确答案: ['KPA']
  最佳正确答案概率: 0.000000 ('KPA')
样本19 错误:
  生成答案: 'Emily Wells'
  正确答案: ['Fleetwood Mac']
  最佳正确答案概率: 0.000000 ('Fleetwood Mac')
样本20 错误:
  生成答案: 'Russia'
  正确答案: ['Norway', 'NO', 'NOR', 'no']
  最佳正确答案概率: 0.000027 ('Norway')
样本21 错误:
  生成答案: '1947'
  正确答案: ['1953']
  最佳正确答案概率: 0.000005 ('1953')
样本22 错误:
  生成答案: 'The dissolution of the Soviet Union.'
  正确答案: ['establishment of the Roman Empire.', 'Roman Empire']
  最佳正确答案概率: 0.000001 ('Roman Empire')
样本23 错误:
  生成答案: 'not provided in the given contexts.'
  正确答案: ['Visva-Bharati University']
  最佳正确答案概率: 0.000000 ('Visva-Bharati University')
样本24 错误:
  生成答案: 'Malta'
  正确答案: ['1773']
  最佳正确答案概率: 0.000000 ('1773')
样本26 错误:
  生成答案: 'I apologize, but the context provided does not answer the question. The question is about Rogers Cable's headquarters, but the context'
  正确答案: ['eastern tip']
  最佳正确答案概率: 0.000000 ('eastern tip')
样本27 错误:
  生成答案: 'Adam Lambert'
  正确答案: ['Peter Grant']
  最佳正确答案概率: 0.000111 ('Peter Grant')
样本28 错误:
  生成答案: 'Eastern Europe'
  正确答案: ['Central Asia']
  最佳正确答案概率: 0.000004 ('Central Asia')
样本29 错误:
  生成答案: 'There is no mention of "Walk on the Wild Side" in the given contexts, so there is no answer to this question'
  正确答案: ['Syracuse University', 'Cuse', 'SU']
  最佳正确答案概率: 0.000001 ('Syracuse University')
样本30 错误:
  生成答案: 'There is no Democratic gubernatorial candidate mentioned in the context.'
  正确答案: ['Laura Kelly']
  最佳正确答案概率: 0.000000 ('Laura Kelly')
样本31 错误:
  生成答案: 'California'
  正确答案: ['United States', 'America', 'US of A', 'US', 'the United States']
  最佳正确答案概率: 0.128906 ('United States')
样本32 错误:
  生成答案: 'July Moyo'
  正确答案: ['Hon July Moyo']
  最佳正确答案概率: 0.325668 ('Hon July Moyo')
样本33 错误:
  生成答案: 'There is no mention of the creator of Prophet Jonah in the given contexts. The contexts are about France Five, Jehovah's Witnesses'
  正确答案: ['Italian painter']
  最佳正确答案概率: 0.000000 ('Italian painter')
样本34 错误:
  生成答案: 'John Lennon'
  正确答案: ['Alfred Lennon']
  最佳正确答案概率: 0.035441 ('Alfred Lennon')
样本35 错误:
  生成答案: 'El Corte Inglés'
  正确答案: ['KaDeWe']
  最佳正确答案概率: 0.000011 ('KaDeWe')
样本36 错误:
  生成答案: '1962'
  正确答案: ['1960']
  最佳正确答案概率: 0.000000 ('1960')
样本37 错误:
  生成答案: 'Season 11.'
  正确答案: ['September 25, 2014']
  最佳正确答案概率: 0.000000 ('September 25, 2014')
样本38 错误:
  生成答案: 'Prairie Creek'
  正确答案: ['Ohio River']
  最佳正确答案概率: 0.000377 ('Ohio River')
样本39 错误:
  生成答案: 'not provided in the given contexts. The context about Khalifa Bin Yousef mentions the unification of'
  正确答案: ['1963']
  最佳正确答案概率: 0.000064 ('1963')
样本40 错误:
  生成答案: 'The European Union.'
  正确答案: ["Europe's most innovative country", 'Europe']
  最佳正确答案概率: 0.240568 ('Europe')
样本41 错误:
  生成答案: '$122,160 (2013)'
  正确答案: ['$122,160']
  最佳正确答案概率: 0.991482 ('$122,160')
样本42 错误:
  生成答案: 'New York City Health and Hospitals Corporation (HHC)'
  正确答案: ['The World Health Organization (WHO)', 'WHO', 'World Health Organization']
  最佳正确答案概率: 0.000001 ('WHO')
样本43 错误:
  生成答案: 'There is no mention of Alanders rejoining a country or the Embassy of France in the given contexts.'
  正确答案: ['December 1917']
  最佳正确答案概率: 0.000000 ('December 1917')
样本44 错误:
  生成答案: 'Not mentioned.'
  正确答案: ['Sophia Akuffo']
  最佳正确答案概率: 0.000000 ('Sophia Akuffo')
样本45 错误:
  生成答案: '1649'
  正确答案: ['1895']
  最佳正确答案概率: 0.000046 ('1895')
样本46 错误:
  生成答案: 'The flag of the United States has 50 stars, not one.'
  正确答案: ['represented the island of Puerto Rico', 'PR', 'Puerto Rico']
  最佳正确答案概率: 0.097973 ('Puerto Rico')
样本47 错误:
  生成答案: 'There is no mention of the Vix Pervenit's author in the given context. The context only talks about the'
  正确答案: ['temple, now a church', 'Temple', 'temple']
  最佳正确答案概率: 0.000001 ('Temple')
样本48 错误:
  生成答案: 'not mentioned in the given context.'
  正确答案: ['1909']
  最佳正确答案概率: 0.000048 ('1909')
样本49 错误:
  生成答案: '21 years of age.'
  正确答案: ['24 hours a day']
  最佳正确答案概率: 0.000000 ('24 hours a day')
样本50 正确:
  生成答案: 'Antarctica'
  最佳正确答案概率: 0.234670 ('Antarctica')
样本51 错误:
  生成答案: 'Connecticut'
  正确答案: ['Rhode Island Department of Transportation', 'RIDOT']
  最佳正确答案概率: 0.000000 ('RIDOT')
样本52 错误:
  生成答案: 'Texas'
  正确答案: ['Charles Carroll']
  最佳正确答案概率: 0.000000 ('Charles Carroll')
样本53 错误:
  生成答案: 'Rome'
评估 w=0.0:  56%|█████▌    | 14/25 [02:33<01:50, 10.01s/it]评估 w=0.0:  60%|██████    | 15/25 [02:41<01:34,  9.42s/it]评估 w=0.0:  64%|██████▍   | 16/25 [02:53<01:31, 10.17s/it]评估 w=0.0:  68%|██████▊   | 17/25 [02:59<01:11,  8.89s/it]评估 w=0.0:  72%|███████▏  | 18/25 [03:16<01:18, 11.22s/it]评估 w=0.0:  76%|███████▌  | 19/25 [03:34<01:20, 13.35s/it]评估 w=0.0:  80%|████████  | 20/25 [03:44<01:02, 12.43s/it]评估 w=0.0:  84%|████████▍ | 21/25 [03:58<00:51, 12.89s/it]评估 w=0.0:  88%|████████▊ | 22/25 [04:02<00:30, 10.15s/it]评估 w=0.0:  92%|█████████▏| 23/25 [04:11<00:19,  9.74s/it]评估 w=0.0:  96%|█████████▌| 24/25 [04:23<00:10, 10.33s/it]评估 w=0.0: 100%|██████████| 25/25 [04:38<00:00, 11.94s/it]评估 w=0.0: 100%|██████████| 25/25 [04:38<00:00, 11.15s/it]
2025-09-12 10:16:50 INFO: - 评估完成
2025-09-12 10:16:50 INFO: - 权重值: 0.0
2025-09-12 10:16:50 INFO: - 输入文件: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
2025-09-12 10:16:50 INFO: - 评估结果: {'weight_w': 0.0, 'input_file': '/home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json', 'total_samples': 100, 'exact_match': 0.07, 'f1': 0.12491904761904761, 'precision': 0.13798232323232323, 'recall': 0.12683333333333333, 'avg_max_log_prob': -15.568131974265215, 'avg_max_prob': 0.052824152319137126, 'avg_total_prob': 0.053346987819416464, 'valid_max_prob_samples': 100, 'invalid_max_prob_samples': 0, 'avg_answer_count': 1.48, 'avg_valid_answer_count': 1.48}
2025-09-12 10:16:50 INFO: - 结果已保存至: /home/jiangjp/trace-idea/results/myidea/MuSiQue/fakenum1/idealsetting/w00/sample_correct_probabilities_w_0.0_documents.json
  正确答案: ['Castel Gandolfo']
  最佳正确答案概率: 0.000000 ('Castel Gandolfo')
样本54 错误:
  生成答案: 'John Hancock.'
  正确答案: ['Charles Carroll']
  最佳正确答案概率: 0.000003 ('Charles Carroll')
样本55 错误:
  生成答案: 'Joseph Chiarello'
  正确答案: ['Catherine Zeta-Jones']
  最佳正确答案概率: 0.000000 ('Catherine Zeta-Jones')
样本56 错误:
  生成答案: 'Meat and rice.'
  正确答案: ['yak meat']
  最佳正确答案概率: 0.000000 ('yak meat')
样本57 错误:
  生成答案: 'Kirkland.'
  正确答案: ['former Acting Mayor London Breed', 'London Breed']
  最佳正确答案概率: 0.000000 ('London Breed')
样本58 错误:
  生成答案: 'Lewis Range'
  正确答案: ['Rocky Mountains']
  最佳正确答案概率: 0.000001 ('Rocky Mountains')
样本59 错误:
  生成答案: 'Guaíra Airport'
  正确答案: ['Tân Sơn Nhất International Airport', 'SGN', 'Tan Son Nhat International Airport']
  最佳正确答案概率: 0.000000 ('Tan Son Nhat International Airport')
样本61 错误:
  生成答案: 'None.'
  正确答案: ['American Idol']
  最佳正确答案概率: 0.000108 ('American Idol')
样本62 错误:
  生成答案: '785'
  正确答案: ['5th–6th centuries', '6th century', '6th-century']
  最佳正确答案概率: 0.000002 ('6th century')
样本63 错误:
  生成答案: 'There is no mention of the person who recognized Jewish synagogues as being legitimate in Rome in the given context. The context'
  正确答案: ['March 44 BC']
  最佳正确答案概率: 0.000000 ('March 44 BC')
样本64 错误:
  生成答案: 'Evan James Springsteen'
  正确答案: ['Harper Simon']
  最佳正确答案概率: 0.000000 ('Harper Simon')
样本65 错误:
  生成答案: '2 weeks.'
  正确答案: ['six months']
  最佳正确答案概率: 0.000040 ('six months')
样本66 错误:
  生成答案: 'There is no mention of the composer of "Get Back" in the given context. The context only talks about the character Susan'
  正确答案: ['James McCartney']
  最佳正确答案概率: 0.000003 ('James McCartney')
样本67 错误:
  生成答案: '509'
  正确答案: ['808']
  最佳正确答案概率: 0.003602 ('808')
样本68 错误:
  生成答案: 'There is no mention of Red Bull F1 in the given contexts. The contexts are about ice hockey and rugby league players,'
  正确答案: ['Louis Renault']
  最佳正确答案概率: 0.000000 ('Louis Renault')
样本69 错误:
  生成答案: 'UTF-16'
  正确答案: ['WGL-4 with 652 characters']
  最佳正确答案概率: 0.000000 ('WGL-4 with 652 characters')
样本70 错误:
  生成答案: 'Ontario.'
  正确答案: ['Pakatan Harapan']
  最佳正确答案概率: 0.000000 ('Pakatan Harapan')
样本71 错误:
  生成答案: 'Not mentioned in the context.'
  正确答案: ['Parliament of India']
  最佳正确答案概率: 0.000011 ('Parliament of India')
样本72 错误:
  生成答案: 'Stanford University'
  正确答案: ['Harvard']
  最佳正确答案概率: 0.000213 ('Harvard')
样本73 错误:
  生成答案: 'The Cavaliers.'
  正确答案: ['unusually high number of day games', 'd', 'day', 'Day', 'days']
  最佳正确答案概率: 0.000081 ('d')
样本74 错误:
  生成答案: 'There is no mention of a "Beth Israel Synagogue" in the given contexts. The context only mentions the Israel Museum,'
  正确答案: ['a month', 'Month', 'month']
  最佳正确答案概率: 0.000000 ('Month')
样本75 错误:
  生成答案: 'I'm happy to help! However, I must point out that the question seems unrelated to the provided context about oil reserves in'
  正确答案: ['totals remain relatively small in relation to the total U.S population.', 'the US', 'America', 'U.S.', 'the United States', 'United States', 'US']
  最佳正确答案概率: 0.000001 ('America')
样本76 错误:
  生成答案: '1983'
  正确答案: ['1998']
  最佳正确答案概率: 0.000028 ('1998')
样本77 错误:
  生成答案: 'Philadelphia'
  正确答案: ['Lincoln Financial Field']
  最佳正确答案概率: 0.055768 ('Lincoln Financial Field')
样本78 错误:
  生成答案: 'Hank Williams Jr.'
  正确答案: ['Aldemaro Romero']
  最佳正确答案概率: 0.000000 ('Aldemaro Romero')
样本79 错误:
  生成答案: 'Robin Roberts'
  正确答案: ['Amna Ilyas']
  最佳正确答案概率: 0.000000 ('Amna Ilyas')
样本80 错误:
  生成答案: 'United States'
  正确答案: ['off the north - western coast of the European mainland']
  最佳正确答案概率: 0.000000 ('off the north - western coast of the European mainland')
样本81 错误:
  生成答案: 'Australia'
  正确答案: ['a key part of the Spanish Empire']
  最佳正确答案概率: 0.000000 ('a key part of the Spanish Empire')
样本82 错误:
  生成答案: 'Sarasota.'
  正确答案: ['165,521']
  最佳正确答案概率: 0.000000 ('165,521')
样本83 错误:
  生成答案: 'Malusi Gigaba'
  正确答案: ['Sudhir Mungantiwar']
  最佳正确答案概率: 0.000000 ('Sudhir Mungantiwar')
样本84 错误:
  生成答案: 'The Nile.'
  正确答案: ['Blue Nile']
  最佳正确答案概率: 0.000000 ('Blue Nile')
样本85 错误:
  生成答案: 'John G. Rice'
  正确答案: ['Steve Jobs']
  最佳正确答案概率: 0.083574 ('Steve Jobs')
样本86 错误:
  生成答案: 'Lionsgate.'
  正确答案: ['Elliot Handler']
  最佳正确答案概率: 0.000000 ('Elliot Handler')
样本87 错误:
  生成答案: '1'
  正确答案: ['49']
  最佳正确答案概率: 0.000000 ('49')
样本88 错误:
  生成答案: 'John Dennis'
  正确答案: ['Arkansas Attorney General']
  最佳正确答案概率: 0.000000 ('Arkansas Attorney General')
样本89 错误:
  生成答案: 'Antoine Marchand'
  正确答案: ['RCA Records', 'RCA']
  最佳正确答案概率: 0.000000 ('RCA')
样本90 错误:
  生成答案: 'There is no mention of Brnakot in the provided contexts.'
  正确答案: ['Kapan']
  最佳正确答案概率: 0.000000 ('Kapan')
样本91 错误:
  生成答案: 'Trajan'
  正确答案: ['Marcia']
  最佳正确答案概率: 0.000001 ('Marcia')
样本92 错误:
  生成答案: 'There is no major railroad related museum located in the metro station nearest to Delhi railway station. The text does not mention any museum'
  正确答案: ['National Rail Museum']
  最佳正确答案概率: 0.000010 ('National Rail Museum')
样本94 错误:
  生成答案: '1967'
  正确答案: ['1824']
  最佳正确答案概率: 0.000000 ('1824')
样本95 错误:
  生成答案: 'Nintendo'
  正确答案: ['first-party games']
  最佳正确答案概率: 0.000000 ('first-party games')
样本97 错误:
  生成答案: 'George William Weidler'
  正确答案: ['Alberto Savinio']
  最佳正确答案概率: 0.000000 ('Alberto Savinio')
样本98 错误:
  生成答案: 'Rhode Island'
  正确答案: ['Seth Magaziner']
  最佳正确答案概率: 0.000000 ('Seth Magaziner')
样本99 错误:
  生成答案: 'Heian-kyō'
  正确答案: ['Qiantang']
  最佳正确答案概率: 0.000000 ('Qiantang')

============================================================
评估结果
============================================================
weight_w: 0.000000
input_file: /home/jiangjp/trace-idea/data/musique/musique_dev100ideal_with_reasoning_chains_modify_w00.json
total_samples: 100
exact_match: 0.070000
f1: 0.124919
precision: 0.137982
recall: 0.126833
avg_max_log_prob: -15.568132
avg_max_prob: 0.052824
avg_total_prob: 0.053347
valid_max_prob_samples: 100
invalid_max_prob_samples: 0
avg_answer_count: 1.480000
avg_valid_answer_count: 1.480000
============================================================

结果已保存至: /home/jiangjp/trace-idea/results/myidea/MuSiQue/fakenum1/idealsetting/w00/sample_correct_probabilities_w_0.0_documents.json

统计信息:
平均每个问题有 1.5 个正确答案
平均每个问题有 1.5 个有效概率的答案
有效概率样本: 100 / 100
